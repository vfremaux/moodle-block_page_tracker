<?php // $Id: config_instance.html,v 1.3 2013-04-29 15:13:35 vf Exp $
/**
 * Instance configuration HTML template for this block.
 *
 * @author Valery Fremaux
 * @version $Id: config_instance.html,v 1.3 2013-04-29 15:13:35 vf Exp $
 * @package block_page_tracker
 **/
 
 	require_once $CFG->dirroot.'/course/format/page/lib.php';

    global $COURSE;
    
    if (!isset($this->config->allowlinks)){
    	$this->config->allowlinks = 0;
    }

    if (!isset($this->config->startpage)){
    	$this->config->startpage = 0;
    }
    
    if (!isset($this->config->depth)){
		$this->config->depth = 0;
    }

?>

<div class="centerpara">
    <table cellpadding="5px" align="center">
        <tr>
            <td align="right" style="font-weight: bold;"><?php print_string('allowlinks', 'block_page_tracker') ?>:&nbsp;</td>
            <td align="left">
            	<?php 
            	$options['0'] = get_string('no');
            	$options['1'] = get_string('yesonvisited', 'block_page_tracker');
            	$options['2'] = get_string('yes');
            	choose_from_menu($options, 'allowlinks', $this->config->allowlinks); 
            ?></td>
        </tr>
    </table>
    <table cellpadding="5px" align="center">
        <tr>
            <td align="right" style="font-weight: bold;"><?php print_string('startpage', 'block_page_tracker') ?>:&nbsp;</td>
            <td align="left">
            	<?php 
            	$options = array();
            	$options['0'] = get_string('root', 'block_page_tracker');
            	$pages = page_get_all_pages($COURSE->id, 'flat');
            	foreach($pages as $p){
            		$options[$p->id] = filter_string($p->nametwo);
            	}
            	choose_from_menu($options, 'startpage', $this->config->startpage); 
            ?></td>
        </tr>
    </table>
    <table cellpadding="5px" align="center">
        <tr>
            <td align="right" style="font-weight: bold;"><?php print_string('depth', 'block_page_tracker') ?>:&nbsp;</td>
            <td align="left">
            	<?php 
            	$leveloptions = array();
            	$leveloptions['100'] = get_string('alllevels', 'block_page_tracker');
            	for($i = 1; $i <= 3; $i++){
            		$leveloptions[$i] = $i;
            	}
            	choose_from_menu($leveloptions, 'depth', $this->config->depth); 
            ?></td>
        </tr>
    </table>
  <p><span class="button"><input type="submit" value="<?php print_string('savechanges'); ?>" /></span></p>
</div>